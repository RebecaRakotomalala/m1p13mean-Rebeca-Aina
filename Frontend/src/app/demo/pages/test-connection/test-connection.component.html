<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <h2 class="mb-4">ğŸ§ª Tests de Connexion</h2>
      <p class="mb-4">VÃ©rifiez que toutes les connexions fonctionnent correctement</p>
    </div>
  </div>

  <div class="row">
    <!-- Test Frontend-Backend -->
    <div class="col-md-4 mb-4">
      <app-card>
        <div class="card-body">
          <h5 class="card-title">1ï¸âƒ£ Test Frontend â†” Backend</h5>
          <div *ngIf="loading.connection" class="text-center py-3">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Chargement...</span>
            </div>
          </div>
          <div *ngIf="!loading.connection && connectionTest" class="mt-3">
            <div class="alert alert-success">
              <strong>âœ… SuccÃ¨s!</strong><br>
              {{ connectionTest.message }}
            </div>
            <small class="text-muted">Status: {{ connectionTest.status }}</small><br>
            <small class="text-muted" *ngIf="connectionTest.timestamp">
              Timestamp: {{ connectionTest.timestamp }}
            </small>
          </div>
          <div *ngIf="!loading.connection && errors.connection" class="mt-3">
            <div class="alert alert-danger">
              <strong>âŒ Erreur!</strong><br>
              {{ errors.connection }}
            </div>
          </div>
          <button 
            class="btn btn-primary mt-3" 
            (click)="testConnection()"
            [disabled]="loading.connection">
            ğŸ”„ Retester
          </button>
        </div>
      </app-card>
    </div>

    <!-- Test MongoDB -->
    <div class="col-md-4 mb-4">
      <app-card>
        <div class="card-body">
          <h5 class="card-title">2ï¸âƒ£ Test Backend â†” MongoDB</h5>
          <div *ngIf="loading.mongodb" class="text-center py-3">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Chargement...</span>
            </div>
          </div>
          <div *ngIf="!loading.mongodb && mongodbTest" class="mt-3">
            <div [class]="mongodbTest.status?.includes('âœ…') ? 'alert alert-success' : 'alert alert-warning'">
              <strong>{{ mongodbTest.status }}</strong><br>
              {{ mongodbTest.message }}
            </div>
            <div *ngIf="mongodbTest['database']" class="mt-2">
              <small><strong>Base de donnÃ©es:</strong> {{ mongodbTest['database'] }}</small><br>
              <small><strong>Host:</strong> {{ mongodbTest['host'] }}</small><br>
              <small><strong>Ã‰tat:</strong> {{ mongodbTest['state'] }}</small>
            </div>
          </div>
          <div *ngIf="!loading.mongodb && errors.mongodb" class="mt-3">
            <div class="alert alert-danger">
              <strong>âŒ Erreur!</strong><br>
              {{ errors.mongodb }}
            </div>
          </div>
          <button 
            class="btn btn-primary mt-3" 
            (click)="testMongoDB()"
            [disabled]="loading.mongodb">
            ğŸ”„ Retester
          </button>
        </div>
      </app-card>
    </div>

    <!-- Test POST -->
    <div class="col-md-4 mb-4">
      <app-card>
        <div class="card-body">
          <h5 class="card-title">3ï¸âƒ£ Test Envoi de DonnÃ©es (POST)</h5>
          <div *ngIf="loading.post" class="text-center py-3">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Chargement...</span>
            </div>
          </div>
          <div *ngIf="!loading.post && postTest" class="mt-3">
            <div class="alert alert-success">
              <strong>âœ… SuccÃ¨s!</strong><br>
              {{ postTest.message }}
            </div>
            <div *ngIf="postTest['receivedData']" class="mt-2">
              <small><strong>DonnÃ©es reÃ§ues:</strong></small>
              <pre class="bg-light p-2 rounded small">{{ postTest['receivedData'] | json }}</pre>
            </div>
          </div>
          <div *ngIf="!loading.post && errors.post" class="mt-3">
            <div class="alert alert-danger">
              <strong>âŒ Erreur!</strong><br>
              {{ errors.post }}
            </div>
          </div>
          <button 
            class="btn btn-primary mt-3" 
            (click)="testPost()"
            [disabled]="loading.post">
            ğŸ”„ Retester
          </button>
        </div>
      </app-card>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-12">
      <button class="btn btn-success btn-lg" (click)="testAll()">
        ğŸ”„ Tester Tout
      </button>
    </div>
  </div>
</div>

