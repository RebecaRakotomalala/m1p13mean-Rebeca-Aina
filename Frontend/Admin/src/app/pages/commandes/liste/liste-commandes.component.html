<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <app-card>
        <div class="card-header">
          <h4>Gestion des Commandes</h4>
        </div>
        <div class="card-body">
          <!-- Filtres -->
          <div class="row mb-3">
            <div class="col-md-2">
              <label class="form-label">Statut</label>
              <select class="form-select" [(ngModel)]="filtres.statut">
                <option value="">Tous</option>
                <option value="en_attente">En attente</option>
                <option value="confirmee">Confirmée</option>
                <option value="en_preparation">En préparation</option>
                <option value="prete">Prête</option>
                <option value="en_livraison">En livraison</option>
                <option value="livree">Livrée</option>
                <option value="annulee">Annulée</option>
              </select>
            </div>
            <div class="col-md-2">
              <label class="form-label">Date début</label>
              <input type="date" class="form-control" [(ngModel)]="filtres.date_debut">
            </div>
            <div class="col-md-2">
              <label class="form-label">Date fin</label>
              <input type="date" class="form-control" [(ngModel)]="filtres.date_fin">
            </div>
            <div class="col-md-4">
              <label class="form-label">Recherche</label>
              <input type="text" class="form-control" placeholder="Numéro de commande..." [(ngModel)]="filtres.recherche">
            </div>
            <div class="col-md-2 d-flex align-items-end">
              <button class="btn btn-primary w-100" (click)="filtrer()">Filtrer</button>
            </div>
          </div>

          <!-- Tableau -->
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>N° Commande</th>
                  <th>Client</th>
                  <th>Montant</th>
                  <th>Statut</th>
                  <th>Date</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let commande of commandes">
                  <td>{{ commande.numero_commande }}</td>
                  <td>{{ commande.client_nom }}</td>
                  <td>{{ commande.montant_total | currency:'EUR' }}</td>
                  <td>
                    <span class="badge" 
                      [class.bg-warning]="commande.statut === 'en_attente'"
                      [class.bg-info]="commande.statut === 'en_preparation'"
                      [class.bg-success]="commande.statut === 'livree'"
                      [class.bg-danger]="commande.statut === 'annulee'">
                      {{ commande.statut }}
                    </span>
                  </td>
                  <td>{{ commande.date_creation | date:'short' }}</td>
                  <td>
                    <button class="btn btn-sm btn-info me-1" [routerLink]="['/commandes', commande._id]">Voir</button>
                    <button class="btn btn-sm btn-primary" (click)="changerStatut(commande._id, 'confirmee')">Modifier</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </app-card>
    </div>
  </div>
</div>
